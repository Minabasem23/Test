<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>External Chat</title>
</head>
<body>
<h2>Send a Message</h2>
<input type="text" id="user" placeholder="Your name">
<input type="text" id="text" placeholder="Message">
<button id="sendBtn">Send</button>
<div id="messages"></div>

<script>
const SERVER_URL = "https://huggingface.co/spaces/Minabasem23/Ad";

const sendBtn = document.getElementById("sendBtn");
const messagesDiv = document.getElementById("messages");

async function updateMessages() {
  try {
    const res = await fetch(`${SERVER_URL}/messages`);
    const msgs = await res.json();
    messagesDiv.innerHTML = msgs.map(m => `<b>${m.user}:</b> ${m.text}`).join("<br>");
  } catch(err) {
    messagesDiv.innerHTML = `<div style="color:red;">${err.message}</div>`;
  }
}

sendBtn.onclick = async () => {
  const user = document.getElementById("user").value.trim();
  const text = document.getElementById("text").value.trim();
  if(!user || !text) return alert("Enter name and message");

  await fetch(`${SERVER_URL}/send_message`, {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({user, text})
  });

  document.getElementById("text").value = "";
  updateMessages();
}

// تحديث تلقائي
updateMessages();
setInterval(updateMessages, 3000);
</script>
</body>
</html>