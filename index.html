<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Send Message App</title>
<style>
body { font-family: Arial; padding: 20px; background:#eef; }
input, button { padding: 10px; margin: 5px 0; width: 100%; }
#messages { margin-top: 20px; border-top: 1px solid #ccc; padding-top: 10px; }
</style>
</head>
<body>

<h2>Send a Message</h2>
<input type="text" id="user" placeholder="Your name">
<input type="text" id="text" placeholder="Message">
<button id="sendBtn">Send</button>

<div id="messages"></div>

<script>
const SERVER_URL = "https://huggingface.co/spaces/Minabasem23/Ad"; // رابط السيرفر الخاص بك

const sendBtn = document.getElementById("sendBtn");
const messagesDiv = document.getElementById("messages");

async function updateMessages() {
  try {
    const res = await fetch(`${SERVER_URL}/messages`);
    const msgs = await res.json();
    messagesDiv.innerHTML = msgs.map(m => `<b>${m.user}:</b> ${m.text}`).join("<br>");
  } catch(e){
    messagesDiv.innerHTML = "Cannot fetch messages (server offline or wrong URL)";
  }
}

sendBtn.onclick = async () => {
  const user = document.getElementById("user").value.trim();
  const text = document.getElementById("text").value.trim();
  if(!user || !text) return alert("Enter name and message");

  try {
    await fetch(`${SERVER_URL}/send_message`, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({user, text})
    });
    document.getElementById("text").value = "";
    updateMessages();
  } catch(e){
    alert("Cannot send message (server offline or wrong URL)");
  }
}

// تحديث الرسائل أول مرة
updateMessages();
</script>

</body>
</html>